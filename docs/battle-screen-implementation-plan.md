# å¤§ä¹æ–—2 æˆ˜æ–—ç”»é¢å®žæ–½è®¡åˆ’

> åŸºäºŽ2025å¹´æœ€æ–°æœ€ä½³å®žè·µçš„å®Œæ•´å®žæ–½æ–¹æ¡ˆ
>
> åˆ›å»ºæ—¶é—´ï¼š2025-12-21

## ðŸ“‹ æ‰§è¡Œæ¦‚è¦

æœ¬è®¡åˆ’ä¸ºå¤§ä¹æ–—2æ¸¸æˆè®¾è®¡å¹¶å®žæ–½ä¸€ä¸ªçŽ°ä»£åŒ–çš„æˆ˜æ–—å¯è§†åŒ–ç•Œé¢ï¼Œå°†çŽ°æœ‰çš„ `simulateBattle` å‡½æ•°è½¬æ¢ä¸ºå¸¦æœ‰åŠ¨ç”»æ•ˆæžœçš„å®žæ—¶æˆ˜æ–—å±•ç¤ºã€‚

**æ ¸å¿ƒç›®æ ‡**ï¼š
- å°†å³æ—¶æˆ˜æ–—ç»“ç®—æ”¹ä¸ºå¯è§†åŒ–å›žæ”¾
- æä¾›æµç•…çš„åŠ¨ç”»å’Œè§†è§‰åé¦ˆ
- ä¿æŒ60fpsæ€§èƒ½å’Œç§»åŠ¨ç«¯é€‚é…
- éµå¾ª2025å¹´æ¸¸æˆUI/UXæœ€ä½³å®žè·µ

**ä»»åŠ¡è§„æ¨¡**ï¼š60+ ä¸ªæœ€å°é¢—ç²’åº¦ä»»åŠ¡ï¼Œåˆ†7ä¸ªé˜¶æ®µå®žæ–½

---

## ðŸ” ç ”ç©¶æˆæžœï¼š2025å¹´æˆ˜æ–—UIæœ€ä½³å®žè·µ

### å…³é”®è®¾è®¡åŽŸåˆ™

#### 1. è§†è§‰æ¸…æ™°åº¦ä¸Žå±‚çº§

- **HPæ¡è®¾è®¡**ï¼šé¢œè‰²ç¼–ç çŠ¶æ€ï¼ˆç»¿è‰²>60%ï¼Œé»„è‰²30-60%ï¼Œçº¢è‰²<30%ï¼‰
- **æŠ€èƒ½æŒ‰é’®**ï¼šé†’ç›®å±•ç¤ºï¼Œå¸¦å†·å´å€’è®¡æ—¶æŒ‡ç¤ºå™¨
- **æˆ˜æ–—æ—¥å¿—**ï¼šè‡ªåŠ¨æ»šåŠ¨ï¼Œé«˜äº®æ˜¾ç¤ºç‰¹æ®Šäº‹ä»¶
- **ä¼¤å®³æ•°å­—**ï¼šé¢œè‰²åŒºåˆ†ï¼ˆæ™®é€š-ç™½è‰²ï¼Œæš´å‡»-é»„è‰²ï¼Œé—ªé¿-ç°è‰²ï¼‰

#### 2. åŠ¨ç”»æ ‡å‡†

- **CSSè¿‡æ¸¡**ï¼šçŠ¶æ€å˜åŒ–ä½¿ç”¨200-300msçš„å¹³æ»‘è¿‡æ¸¡
- **äº¤é”™åŠ¨ç”»**ï¼šé¡ºåºäº‹ä»¶é‡‡ç”¨é˜¶æ¢¯å¼æ’­æ”¾
- **ç²’å­ç‰¹æ•ˆ**ï¼šæš´å‡»å’ŒæŠ€èƒ½æ¿€æ´»æ—¶çš„è§†è§‰å¢žå¼º
- **è§’è‰²ç²¾çµ**ï¼šæ”»å‡»ã€å—å‡»ã€å¾…æœºçŠ¶æ€åˆ‡æ¢åŠ¨ç”»

#### 3. ç§»åŠ¨ä¼˜å…ˆè§¦æŽ§è®¾è®¡

- **å¤§è§¦æŽ§ç›®æ ‡**ï¼šæœ€å°44x44pxçš„å¯ç‚¹å‡»åŒºåŸŸ
- **è§†è§‰åé¦ˆ**ï¼šæ‰€æœ‰äº¤äº’éƒ½æœ‰å³æ—¶åé¦ˆ
- **æ»‘åŠ¨æ‰‹åŠ¿**ï¼šæˆ˜æ–—æ—¥å¿—æ”¯æŒæ»‘åŠ¨æ»šåŠ¨
- **å“åº”å¼å¸ƒå±€**ï¼šç§»åŠ¨ä¼˜å…ˆï¼Œæ¡Œé¢å¢žå¼º

#### 4. æ€§èƒ½ä¼˜åŒ–

- **CSSåŠ¨ç”»ä¼˜å…ˆ**ï¼šä¼˜å…ˆä½¿ç”¨CSSè€ŒéžJavaScriptåŠ¨ç”»
- **requestAnimationFrame**ï¼šå¤æ‚åŠ¨ç”»ä½¿ç”¨RAF
- **æ‡’æ¸²æŸ“**ï¼šæˆ˜æ–—æ—¥å¿—æ¡ç›®æŒ‰éœ€æ¸²æŸ“
- **ä¼˜åŒ–é‡æ¸²æŸ“**ï¼šä½¿ç”¨React.memoå‡å°‘ä¸å¿…è¦çš„æ›´æ–°

---

## ðŸ—ï¸ çŽ°æœ‰ä»£ç åº“åˆ†æž

### å½“å‰æž¶æž„
```
/home/user/-2/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â”œâ”€â”€ battle.ts          # æ ¸å¿ƒæˆ˜æ–—æ¨¡æ‹Ÿé€»è¾‘
â”‚   â”‚   â”œâ”€â”€ models.ts           # TypeScriptæŽ¥å£å®šä¹‰
â”‚   â”‚   â””â”€â”€ balance.ts          # æ¸¸æˆå¹³è¡¡å¸¸é‡
â”‚   â”œâ”€â”€ application/
â”‚   â”‚   â””â”€â”€ battleResolver.ts   # æˆ˜æ–—è§£æžæœåŠ¡
â”‚   â”œâ”€â”€ state/
â”‚   â”‚   â””â”€â”€ gameStore.ts        # ZustandçŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ PlayPage.tsx        # å½“å‰æˆ˜æ–—è§¦å‘UI
â”‚   â”‚   â””â”€â”€ LogPage.tsx         # æˆ˜æ–—åŽ†å²å±•ç¤º
â”‚   â””â”€â”€ App.tsx                 # è·¯ç”±é…ç½®
```

### çŽ°æœ‰åŠŸèƒ½ç‰¹æ€§

- **æˆ˜æ–—æ¨¡æ‹Ÿ**ï¼š`/home/user/-2/src/domain/battle.ts` ä¸­å®Œæ•´çš„å›žåˆåˆ¶æˆ˜æ–—
- **çŠ¶æ€ç®¡ç†**ï¼š`/home/user/-2/src/state/gameStore.ts` ä¸­çš„æˆ˜æ–—åŽ†å²
- **æˆ˜æ–—æ¨¡åž‹**ï¼š`BattleRecord`ã€`TurnLogEntry`ã€`Hero`ã€`Skill` æŽ¥å£
- **æ ·å¼ç³»ç»Ÿ**ï¼šTailwind CSS + è‡ªå®šä¹‰ä¸»é¢˜ï¼ˆæš—é»‘æ¨¡å¼ï¼Œä¸­æ–‡å­—ä½“ï¼‰

### å½“å‰æµç¨‹

1. ç”¨æˆ·åœ¨ PlayPage ç‚¹å‡»"å‘èµ·ä¹æ–—"æŒ‰é’®
2. `runBattle(stageId)` çž¬é—´æ‰§è¡Œå®Œæˆ
3. æˆ˜æ–—ç»“æžœå­˜å‚¨åˆ°çŠ¶æ€ä¸­
4. ç”¨æˆ·å¯¼èˆªåˆ° LogPage æŸ¥çœ‹æ‘˜è¦

**ç¼ºå£**ï¼šç¼ºå°‘æˆ˜æ–—è¿‡ç¨‹çš„å®žæ—¶å¯è§†åŒ–ï¼

---

## ðŸŽ¨ æˆ˜æ–—ç”»é¢è®¾è®¡æ–¹æ¡ˆ

### è§†è§‰å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [â† è¿”å›ž] ä¼é¹…æ‘éƒŠå¤– vs æµæµªä¼é¹…    [X]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      VS      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   è‹±é›„    â”‚              â”‚  æ•Œäºº   â”‚ â”‚
â”‚  â”‚   å¤´åƒ    â”‚              â”‚  å¤´åƒ   â”‚ â”‚
â”‚  â”‚           â”‚              â”‚         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚  æ–°æ™‹å°‘ä¾  Lv.5               æµæµªä¼é¹…   â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80/100           â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 40/50â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æˆ˜æ–—æ—¥å¿—                       â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚   â”‚
â”‚  â”‚  å›žåˆ1: æ–°æ™‹å°‘ä¾  æ–½å±• ç ´å†›æ–©      â”‚   â”‚
â”‚  â”‚         é€ æˆ 45 ç‚¹ä¼¤å®³ è§¦å‘æš´å‡»   â”‚   â”‚
â”‚  â”‚  å›žåˆ2: æµæµªä¼é¹… æ–½å±• ä¹±ç¾½å•„      â”‚   â”‚
â”‚  â”‚         è¢«å¯¹æ‰‹é—ªé¿               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ç ´å†›æ–© â”‚ â”‚ç½¡æ°”  â”‚ â”‚æ™®é€š  â”‚        â”‚
â”‚  â”‚ å°±ç»ª  â”‚ â”‚CD: 2 â”‚ â”‚æ”»å‡»  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                         â”‚
â”‚         [ç»§ç»­] or [è·³è¿‡åŠ¨ç”»]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åŠ¨ç”»æµç¨‹

#### 1. æˆ˜æ–—å¼€å§‹ (0ç§’)
- æ·¡å…¥ç«žæŠ€åœºèƒŒæ™¯
- è‹±é›„ä»Žå·¦ä¾§æ»‘å…¥ï¼Œæ•Œäººä»Žå³ä¾§æ»‘å…¥
- HPæ¡ä»Ž0åŠ¨ç”»åˆ°æ»¡å€¼

#### 2. å›žåˆæ‰§è¡Œ (æ¯å›žåˆ ~2ç§’)
- æ”»å‡»è€…å‘å…‰/è„‰å†²æ•ˆæžœ (300ms)
- æŠ€èƒ½åç§°å‡ºçŽ°åœ¨æ”»å‡»è€…ä¸Šæ–¹ (500ms)
- æ”»å‡»åŠ¨ç”»ï¼šæ”»å‡»è€…å‘å‰ç§»åŠ¨
- å‘½ä¸­/é—ªé¿ç‰¹æ•ˆåœ¨é˜²å¾¡è€…èº«ä¸Š
- ä¼¤å®³æ•°å­—å‘ä¸Šé£˜åŠ¨å¹¶å¸¦åŠ¨ç”»
- HPæ¡å¹³æ»‘å‡å°‘è¿‡æ¸¡
- æˆ˜æ–—æ—¥å¿—æ–°æ¡ç›®æ·¡å…¥åº•éƒ¨

#### 3. æˆ˜æ–—ç»“æŸ (3ç§’)
- èƒœåˆ©/å¤±è´¥æ¨ªå¹…æ»‘ä¸‹
- èƒœåˆ©æ—¶æ’­æ”¾å½©å¸¦/ç²’å­æ•ˆæžœ
- å¥–åŠ±é¢æ¿æ·¡å…¥
- "ç»§ç»­"æŒ‰é’®å‡ºçŽ°

---

## ðŸ“ å®žæ–½è®¡åˆ’ï¼šæœ€å°é¢—ç²’åº¦ä»»åŠ¡åˆ†è§£

### Phase 1: åŸºç¡€ç»“æž„ä¸Žç»„ä»¶ (7ä¸ªä»»åŠ¡)

#### ä»»åŠ¡ 1.1: åˆ›å»º BattleScreen é¡µé¢ç»„ä»¶
- **æ–‡ä»¶**: `/home/user/-2/src/pages/BattlePage.tsx`
- **å†…å®¹**:
  - è®¾ç½®åŸºæœ¬ç»„ä»¶ç»“æž„ä¸Ž TypeScript ç±»åž‹
  - ä»Ž domain models å¯¼å…¥æ‰€éœ€ç±»åž‹
  - åˆ›å»ºå ä½UIï¼šå¤´éƒ¨å’Œè¿”å›žæŒ‰é’®
  - åœ¨ `/home/user/-2/src/App.tsx` æ·»åŠ è·¯ç”±: `/battle/:stageId`
- **éªŒæ”¶**: å¯ä»¥å¯¼èˆªåˆ° /battle/1 å¹¶çœ‹åˆ°åŸºæœ¬é¡µé¢æ¡†æž¶

#### ä»»åŠ¡ 1.2: åˆ›å»º BattleArena ç»„ä»¶
- **æ–‡ä»¶**: `/home/user/-2/src/components/BattleArena.tsx`
- **Props**: `hero`, `enemy`, `heroHp`, `enemyHp`
- **å†…å®¹**:
  - å¹¶æŽ’æ¸²æŸ“ä¸¤ä¸ªæˆ˜æ–—è€…å¡ç‰‡
  - ä¸­é—´æ·»åŠ "VS"æŒ‡ç¤ºå™¨
  - ä½¿ç”¨ Tailwind å“åº”å¼ç½‘æ ¼ï¼ˆç§»åŠ¨ç«¯ï¼šå †å ï¼Œæ¡Œé¢ç«¯ï¼šå¹¶æŽ’ï¼‰
- **éªŒæ”¶**: ä¸¤ä¸ªå ä½å¡ç‰‡æ­£ç¡®å¸ƒå±€ï¼Œå“åº”å¼å·¥ä½œæ­£å¸¸

#### ä»»åŠ¡ 1.3: åˆ›å»º CombatantCard ç»„ä»¶
- **æ–‡ä»¶**: `/home/user/-2/src/components/CombatantCard.tsx`
- **Props**: `name`, `level`, `currentHp`, `maxHp`, `isActive`, `side`
- **å†…å®¹**:
  - æ˜¾ç¤ºå¤´åƒå ä½ç¬¦ï¼ˆå¸¦æ¸å˜èƒŒæ™¯çš„divï¼‰
  - å±•ç¤ºåç§°å’Œç­‰çº§
  - åŒ…å« HPæ¡ç»„ä»¶ï¼ˆå•ç‹¬åˆ›å»ºï¼‰
  - å½“ `isActive` ä¸º true æ—¶æ·»åŠ å‘å…‰æ•ˆæžœ
- **éªŒæ”¶**: å¡ç‰‡æ­£ç¡®æ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯ï¼Œæ¿€æ´»çŠ¶æ€æœ‰è§†è§‰åé¦ˆ

#### ä»»åŠ¡ 1.4: åˆ›å»º HPBar ç»„ä»¶
- **æ–‡ä»¶**: `/home/user/-2/src/components/HPBar.tsx`
- **Props**: `current`, `max`, `animated`, `color`
- **å†…å®¹**:
  - å®žçŽ°ç™¾åˆ†æ¯”è®¡ç®—
  - ä¸ºå®½åº¦å˜åŒ–æ·»åŠ å¹³æ»‘CSSè¿‡æ¸¡
  - é¢œè‰²æ¸å˜: ç»¿è‰² (>60%), é»„è‰² (30-60%), çº¢è‰² (<30%)
  - æ˜¾ç¤ºæ•°å€¼HP: "80/100"
- **éªŒæ”¶**: HPæ¡é¢œè‰²æ­£ç¡®ï¼Œå®½åº¦å˜åŒ–å¹³æ»‘

#### ä»»åŠ¡ 1.5: åˆ›å»º SkillBar ç»„ä»¶
- **æ–‡ä»¶**: `/home/user/-2/src/components/SkillBar.tsx`
- **Props**: `skills`, `cooldowns`, `activeSkillId`
- **å†…å®¹**:
  - æ¨ªå‘æŽ’åˆ—æ¸²æŸ“æŠ€èƒ½æŒ‰é’®
  - æ˜¾ç¤ºæŠ€èƒ½åç§°ã€å†·å´å€’è®¡æ—¶
  - å†·å´ä¸­çš„æŠ€èƒ½ç¦ç”¨/å˜ç°
  - é«˜äº®æ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨çš„æŠ€èƒ½
- **éªŒæ”¶**: æŠ€èƒ½æ­£ç¡®æ˜¾ç¤ºï¼Œå†·å´çŠ¶æ€å’Œæ¿€æ´»çŠ¶æ€è§†è§‰åŒºåˆ†æ˜Žæ˜¾

#### ä»»åŠ¡ 1.6: åˆ›å»º BattleLog ç»„ä»¶
- **æ–‡ä»¶**: `/home/user/-2/src/components/BattleLog.tsx`
- **Props**: `entries`, `maxVisible`, `autoScroll`
- **å†…å®¹**:
  - æ¸²æŸ“å¯æ»šåŠ¨çš„æˆ˜æ–—äº‹ä»¶åˆ—è¡¨
  - é™åˆ¶å¯è§æ¡ç›®æ•°ï¼ˆé»˜è®¤5æ¡ï¼Œæ˜¾ç¤ºæ»šåŠ¨æŒ‡ç¤ºå™¨ï¼‰
  - æ–°æ¡ç›®æ·»åŠ æ—¶è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
  - ç”¨ä¸­æ–‡æ ¼å¼åŒ–å›žåˆæ¡ç›®
- **éªŒæ”¶**: æ—¥å¿—æ­£ç¡®æ»šåŠ¨ï¼Œè‡ªåŠ¨æ»šåŠ¨åŠŸèƒ½æ­£å¸¸

#### ä»»åŠ¡ 1.7: åˆ›å»º BattleLogEntry ç»„ä»¶
- **æ–‡ä»¶**: `/home/user/-2/src/components/BattleLogEntry.tsx`
- **Props**: `turn`, `actor`, `description`, `critical`, `hit`
- **å†…å®¹**:
  - æ ¹æ®æ¡ç›®ç±»åž‹ï¼ˆå‘½ä¸­/é—ªé¿/æš´å‡»ï¼‰è®¾ç½®æ ·å¼
  - ä¸ºä¸åŒäº‹ä»¶ç±»åž‹æ·»åŠ å›¾æ ‡
  - æ¡ç›®å‡ºçŽ°æ—¶çš„æ·¡å…¥åŠ¨ç”»
  - é¢œè‰²ç¼–ç : æ™®é€š(ç™½è‰²), æš´å‡»(é»„è‰²), é—ªé¿(ç°è‰²)
- **éªŒæ”¶**: æ—¥å¿—æ¡ç›®æ ¹æ®ç±»åž‹æ­£ç¡®ç€è‰²ï¼Œæ·¡å…¥åŠ¨ç”»æµç•…

---

### Phase 2: æˆ˜æ–—çŠ¶æ€ç®¡ç† (4ä¸ªä»»åŠ¡)

#### ä»»åŠ¡ 2.1: æ‰©å±• Zustand Store æ”¯æŒæˆ˜æ–—UI
- **æ–‡ä»¶**: `/home/user/-2/src/state/gameStore.ts`
- **å†…å®¹**:
  - æ·»åŠ  `activeBattle` çŠ¶æ€: å½“å‰æˆ˜æ–—æ¨¡æ‹Ÿ
  - æ·»åŠ  `battlePlayback` çŠ¶æ€: å½“å‰å›žåˆç´¢å¼•ã€æ’­æ”¾çŠ¶æ€
  - æ·»åŠ  `startBattle(stageId)` action
  - æ·»åŠ  `advanceTurn()` action
  - æ·»åŠ  `skipToEnd()` action
- **éªŒæ”¶**: çŠ¶æ€æ›´æ–°æ­£ç¡®ï¼Œactions å¯ä»¥è°ƒç”¨

#### ä»»åŠ¡ 2.2: åˆ›å»º useBattlePlayback Hook
- **æ–‡ä»¶**: `/home/user/-2/src/hooks/useBattlePlayback.ts`
- **å‚æ•°**: `battleRecord`
- **è¿”å›ž**: `currentTurn`, `isPlaying`, `play()`, `pause()`, `skip()`
- **å†…å®¹**:
  - ä½¿ç”¨ `useEffect` é…åˆ interval å®žçŽ°è‡ªåŠ¨æ’­æ”¾
  - åœ¨æœ¬åœ°çŠ¶æ€ä¸­è·Ÿè¸ªå½“å‰å›žåˆç´¢å¼•
  - åŸºäºŽå›žåˆè®¡ç®—åŒæ–¹å½“å‰HP
- **éªŒæ”¶**: Hook æ­£ç¡®ç®¡ç†å›žæ”¾çŠ¶æ€ï¼ŒHP è®¡ç®—å‡†ç¡®

#### ä»»åŠ¡ 2.3: åˆ›å»º useBattleAnimation Hook
- **æ–‡ä»¶**: `/home/user/-2/src/hooks/useBattleAnimation.ts`
- **å‚æ•°**: `currentTurn`, `previousTurn`
- **è¿”å›ž**: åŠ¨ç”»çŠ¶æ€: `attackerActive`, `defenderHit`, `showDamage`
- **å†…å®¹**:
  - ä½¿ç”¨çŠ¶æ€æœºæ¨¡å¼ç®¡ç†åŠ¨ç”»é˜¶æ®µ
  - æ—¶åº: å‘å…‰(300ms) â†’ æ”»å‡»(500ms) â†’ å‘½ä¸­(400ms) â†’ ç»“ç®—(300ms)
- **éªŒæ”¶**: åŠ¨ç”»çŠ¶æ€æŒ‰æ­£ç¡®é¡ºåºåˆ‡æ¢

#### ä»»åŠ¡ 2.4: åˆ›å»ºæˆ˜æ–—æ—¶é—´å¸¸é‡
- **æ–‡ä»¶**: `/home/user/-2/src/domain/battleAnimationConfig.ts`
- **å†…å®¹**:
  - å¯¼å‡ºæ—¶é—´å¸¸é‡: `TURN_DURATION`, `ATTACK_DELAY`, `HIT_DELAY`
  - å¯¼å‡ºåŠ¨ç”»é€Ÿåº¦: `NORMAL_SPEED`, `FAST_SPEED`, `INSTANT`
  - å¯¼å‡ºå›žæ”¾è®¾ç½®: `AUTO_PLAY_DEFAULT`, `SKIP_AVAILABLE`
- **éªŒæ”¶**: å¸¸é‡å¯ä»¥åœ¨å…¶ä»–æ–‡ä»¶ä¸­å¯¼å…¥ä½¿ç”¨

---

### Phase 3: åŠ¨ç”»ç³»ç»Ÿ (5ä¸ªä»»åŠ¡)

#### ä»»åŠ¡ 3.1: åˆ›å»º DamageNumber ç»„ä»¶
- **æ–‡ä»¶**: `/home/user/-2/src/components/DamageNumber.tsx`
- **Props**: `value`, `isCritical`, `isMiss`, `position`
- **å†…å®¹**:
  - ç»å¯¹å®šä½åœ¨ç›®æ ‡ä¸Šæ–¹
  - å‘ä¸Šé£˜åŠ¨ç”»ï¼ˆtranslate Y -50px, æ·¡å‡ºï¼‰
  - æš´å‡»æ—¶çš„ç¼©æ”¾åŠ¨ç”»
  - CSS keyframe åŠ¨ç”»ï¼Œ1.5ç§’åŽè‡ªåŠ¨ç§»é™¤
- **éªŒæ”¶**: ä¼¤å®³æ•°å­—æ­£ç¡®æ˜¾ç¤ºå¹¶åŠ¨ç”»ï¼Œæš´å‡»æœ‰ç‰¹æ®Šæ•ˆæžœ

#### ä»»åŠ¡ 3.2: åˆ›å»º AttackEffect ç»„ä»¶
- **æ–‡ä»¶**: `/home/user/-2/src/components/AttackEffect.tsx`
- **Props**: `type` ('slash', 'strike', 'burst'), `target`, `active`
- **å†…å®¹**:
  - åŸºäºŽSVGçš„æ”»å‡»åŠ¨ç”»
  - Slash: å¯¹è§’çº¿åŠ¨ç”»
  - Strike: æ‰©æ•£çš„å†²å‡»åœ†
  - Burst: å‘å¤–è¾å°„çš„ç²’å­
- **éªŒæ”¶**: ä¸åŒæ”»å‡»ç±»åž‹æ˜¾ç¤ºä¸åŒç‰¹æ•ˆ

#### ä»»åŠ¡ 3.3: æ·»åŠ è§’è‰²ç²¾çµåŠ¨ç”»
- **æ–‡ä»¶**: å¢žå¼º `CombatantCard`
- **å†…å®¹**:
  - æ·»åŠ åŠ¨ç”»çŠ¶æ€çš„CSSç±»
  - ä¸ºä»¥ä¸‹çŠ¶æ€åˆ›å»ºCSSåŠ¨ç”»: idle, attack, hit, victory, defeat
  - Attack: å‘å¯¹æ‰‹æ–¹å‘translate-xåŽè¿”å›ž
  - Hit: éœ‡åŠ¨åŠ¨ç”» (translate-x Â±5px)
  - Victory: å¼¹è·³åŠ¨ç”»
  - Defeat: æ·¡å‡º + ç¼©å°
- **éªŒæ”¶**: è§’è‰²æ ¹æ®çŠ¶æ€æ’­æ”¾æ­£ç¡®åŠ¨ç”»

#### ä»»åŠ¡ 3.4: åˆ›å»ºç²’å­ç³»ç»Ÿç»„ä»¶
- **æ–‡ä»¶**: `/home/user/-2/src/components/ParticleEffect.tsx`
- **Props**: `type` ('crit', 'miss', 'victory'), `origin`, `active`
- **å†…å®¹**:
  - ç”¨CSSåŠ¨ç”»ç”Ÿæˆéšæœºç²’å­
  - Crit: é»„è‰²æ˜Ÿæ˜Ÿå‘å¤–çˆ†å‘
  - Miss: ç°è‰²"..."æ°”æ³¡å‘ä¸Šé£˜
  - Victory: é‡‘è‰²å½©å¸¦ä¸‹è½
- **éªŒæ”¶**: ç²’å­æ•ˆæžœåœ¨é€‚å½“æ—¶æœºè§¦å‘ï¼Œè§†è§‰æ•ˆæžœè‰¯å¥½

#### ä»»åŠ¡ 3.5: åˆ›å»ºæˆ˜æ–—èƒœåˆ©/å¤±è´¥å¼¹çª—
- **æ–‡ä»¶**: `/home/user/-2/src/components/BattleResultModal.tsx`
- **Props**: `outcome`, `rewards`, `onContinue`, `onReplay`
- **å†…å®¹**:
  - å¸¦èƒŒæ™¯æ¨¡ç³Šçš„é®ç½©å±‚
  - å¼¹çª—çš„æ»‘ä¸‹åŠ¨ç”»
  - æ˜¾ç¤ºç»“æžœæ¨ªå¹…ï¼ˆèƒœåˆ©/è´¥åŒ—ï¼‰
  - å±•ç¤ºèŽ·å¾—çš„å¥–åŠ±
  - æŒ‰é’®: "ç»§ç»­"(continue), "é‡æ’­"(replay)
- **éªŒæ”¶**: å¼¹çª—æ­£ç¡®æ˜¾ç¤ºï¼ŒåŠ¨ç”»æµç•…ï¼ŒæŒ‰é’®å“åº”æ­£å¸¸

---

### Phase 4: æˆ˜æ–—æµç¨‹é›†æˆ (5ä¸ªä»»åŠ¡)

#### ä»»åŠ¡ 4.1: é›†æˆæˆ˜æ–—å¼€å§‹æµç¨‹
- **æ–‡ä»¶**: `BattlePage.tsx`
- **å†…å®¹**:
  - ç»„ä»¶æŒ‚è½½æ—¶è°ƒç”¨ `startBattle(stageId)`
  - æˆ˜æ–—æ¨¡æ‹Ÿæ—¶æ˜¾ç¤ºåŠ è½½çŠ¶æ€
  - å°±ç»ªåŽè¿‡æ¸¡åˆ°æˆ˜æ–—ç«žæŠ€åœº
  - æ’­æ”¾å…¥åœºåŠ¨ç”»ï¼ˆè‹±é›„/æ•Œäººæ»‘å…¥ï¼‰
  - 1ç§’å»¶è¿ŸåŽè‡ªåŠ¨å¼€å§‹å›žåˆå›žæ”¾
- **éªŒæ”¶**: æˆ˜æ–—æµç•…å¯åŠ¨ï¼Œå…¥åœºåŠ¨ç”»æ­£ç¡®æ’­æ”¾

#### ä»»åŠ¡ 4.2: å®žçŽ°é€å›žåˆå›žæ”¾
- **æ–‡ä»¶**: `BattlePage.tsx`
- **å†…å®¹**:
  - åœ¨ BattlePage ä¸­ä½¿ç”¨ `useBattlePlayback` hook
  - å°†å½“å‰å›žåˆæ•°æ®æ˜ å°„åˆ°ç»„ä»¶ props
  - åŸºäºŽå›žåˆä¼¤å®³æ›´æ–° HPBar å€¼
  - æ¯å›žåˆå‘ BattleLog æ·»åŠ æ–°æ¡ç›®
  - åœ¨ SkillBar ä¸­é«˜äº®æ¿€æ´»çš„æŠ€èƒ½
  - ä¸ºæ¯æ¬¡æ”»å‡»æ˜¾ç¤ºä¼¤å®³æ•°å­—
- **éªŒæ”¶**: å›žæ”¾é€å›žåˆæ‰§è¡Œï¼Œæ‰€æœ‰UIå…ƒç´ åŒæ­¥æ›´æ–°

#### ä»»åŠ¡ 4.3: æ·»åŠ å›žæ”¾æŽ§åˆ¶
- **æ–‡ä»¶**: `/home/user/-2/src/components/BattleControls.tsx`
- **Props**: `isPlaying`, `onPlay`, `onPause`, `onSkip`, `speed`
- **å†…å®¹**:
  - æŒ‰é’®: æ’­æ”¾/æš‚åœåˆ‡æ¢ã€è·³åˆ°ç»“å°¾ã€é€Ÿåº¦æŽ§åˆ¶
  - ä½ç½®: å±å¹•åº•éƒ¨ä¸­å¤®
  - æ˜¾ç¤ºè¿›åº¦æŒ‡ç¤ºå™¨ï¼ˆå›žåˆ X / Yï¼‰
  - é”®ç›˜å¿«æ·é”®: ç©ºæ ¼(æ’­æ”¾/æš‚åœ), â†’(ä¸‹ä¸€å›žåˆ), S(è·³è¿‡)
- **éªŒæ”¶**: æ‰€æœ‰æŽ§åˆ¶æŒ‰é’®æ­£å¸¸å·¥ä½œï¼Œé”®ç›˜å¿«æ·é”®å“åº”

#### ä»»åŠ¡ 4.4: å¤„ç†æˆ˜æ–—ç»“æŸçŠ¶æ€
- **æ–‡ä»¶**: `BattlePage.tsx`, `useBattlePlayback`
- **å†…å®¹**:
  - åœ¨ useBattlePlayback ä¸­æ£€æµ‹æ‰€æœ‰å›žåˆæ’­æ”¾å®Œæ¯•
  - æœ€åŽä¸€å›žåˆè§¦å‘èƒœåˆ©/å¤±è´¥åŠ¨ç”»
  - 2ç§’å»¶è¿ŸåŽæ˜¾ç¤º BattleResultModal
  - ä»Ž store è®¡ç®—å¹¶æ˜¾ç¤ºå¥–åŠ±
  - ç”¨æˆ·ç»§ç»­æ—¶æ›´æ–° store ä¸­çš„è‹±é›„æ•°æ®
  - å¯¼èˆªå›ž PlayPage æˆ–æ˜¾ç¤ºé‡æ’­é€‰é¡¹
- **éªŒæ”¶**: æˆ˜æ–—æ­£ç¡®ç»“æŸï¼Œå¥–åŠ±æ­£ç¡®æ˜¾ç¤ºå’Œå‘æ”¾

#### ä»»åŠ¡ 4.5: æ·»åŠ é”™è¯¯å¤„ç†
- **æ–‡ä»¶**: `BattlePage.tsx`
- **å†…å®¹**:
  - ç”¨ try-catch åŒ…è£¹æˆ˜æ–—æ¨¡æ‹Ÿ
  - æˆ˜æ–—åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºé”™è¯¯å¼¹çª—
  - æä¾›"è¿”å›žå…³å¡"é™çº§é€‰é¡¹
  - å°†é”™è¯¯è®°å½•åˆ° console ç”¨äºŽè°ƒè¯•
  - ä¼˜é›…å¤„ç†ç¼ºå¤±çš„å…³å¡æ•°æ®
- **éªŒæ”¶**: é”™è¯¯æƒ…å†µä¸‹ä¸ä¼šå´©æºƒï¼Œç”¨æˆ·å¯ä»¥å®‰å…¨é€€å‡º

---

### Phase 5: ä¼˜åŒ–æ‰“ç£¨ (5ä¸ªä»»åŠ¡)

#### ä»»åŠ¡ 5.1: æ·»åŠ éŸ³æ•ˆï¼ˆå¯é€‰ï¼‰
- **æ–‡ä»¶**: `/home/user/-2/src/utils/soundManager.ts`
- **å†…å®¹**:
  - å®šä¹‰éŸ³æ•ˆè·¯å¾„ï¼ˆæ”»å‡»ã€å‘½ä¸­ã€æš´å‡»ã€èƒœåˆ©ã€å¤±è´¥ï¼‰
  - ä½¿ç”¨ Web Audio API æ’­æ”¾
  - åœ¨æˆ˜æ–—æŽ§åˆ¶ä¸­æ·»åŠ é™éŸ³åˆ‡æ¢
  - ç»„ä»¶æŒ‚è½½æ—¶é¢„åŠ è½½éŸ³æ•ˆ
  - éŸ³æ•ˆä¸ŽåŠ¨ç”»åŒæ­¥æ’­æ”¾
- **éªŒæ”¶**: éŸ³æ•ˆæ­£ç¡®æ’­æ”¾ï¼Œé™éŸ³å¼€å…³å·¥ä½œæ­£å¸¸

#### ä»»åŠ¡ 5.2: ä¼˜åŒ–é‡æ¸²æŸ“
- **æ–‡ä»¶**: å„ç»„ä»¶æ–‡ä»¶
- **å†…å®¹**:
  - ç”¨ React.memo åŒ…è£¹ CombatantCard
  - ç”¨ React.memo åŒ…è£¹ BattleLogEntry
  - ä¸ºäº‹ä»¶å¤„ç†å™¨ä½¿ç”¨ useCallback
  - ä¸ºé«˜å¼€é”€è®¡ç®—ä½¿ç”¨ useMemoï¼ˆå¦‚HPç™¾åˆ†æ¯”ï¼‰
  - æ‡’åŠ è½½ BattleResultModal
  - æ¡ç›®è¶…è¿‡20æ¡æ—¶è™šæ‹ŸåŒ–æˆ˜æ–—æ—¥å¿—
- **éªŒæ”¶**: æ€§èƒ½åˆ†æžæ˜¾ç¤ºé‡æ¸²æŸ“æ˜¾è‘—å‡å°‘

#### ä»»åŠ¡ 5.3: æ·»åŠ æ— éšœç¢åŠŸèƒ½
- **æ–‡ä»¶**: æ‰€æœ‰äº¤äº’ç»„ä»¶
- **å†…å®¹**:
  - ä¸ºæ‰€æœ‰å¯äº¤äº’å…ƒç´ æ·»åŠ  ARIA æ ‡ç­¾
  - æˆ˜æ–—æŽ§åˆ¶çš„é”®ç›˜å¯¼èˆª
  - å›žåˆäº‹ä»¶çš„å±å¹•é˜…è¯»å™¨æ’­æŠ¥
  - HPæ¡çš„é«˜å¯¹æ¯”åº¦æ¨¡å¼
  - å‡å°‘åŠ¨ç”»é€‰é¡¹ï¼ˆè·³è¿‡åŠ¨ç”»ï¼‰
  - å¼¹çª—çš„ç„¦ç‚¹ç®¡ç†
- **éªŒæ”¶**: é€šè¿‡ axe-core æ— éšœç¢æµ‹è¯•

#### ä»»åŠ¡ 5.4: å“åº”å¼è®¾è®¡æµ‹è¯•
- **æµ‹è¯•çŽ¯å¢ƒ**:
  - ç§»åŠ¨ç«¯ï¼ˆ375px å®½åº¦ï¼‰
  - å¹³æ¿ï¼ˆ768px å®½åº¦ï¼‰
  - æ¡Œé¢ç«¯ï¼ˆ1440px å®½åº¦ï¼‰
- **å†…å®¹**:
  - è°ƒæ•´ç§»åŠ¨ç«¯çš„æˆ˜æ–—è€…å¡ç‰‡å¤§å°
  - çª„å±æ—¶å †å æŠ€èƒ½æŒ‰é’®
  - ç¡®ä¿è§¦æŽ§ç›®æ ‡ â‰¥44px
- **éªŒæ”¶**: æ‰€æœ‰è®¾å¤‡å°ºå¯¸ä¸‹UIæ­£å¸¸æ˜¾ç¤ºå’Œäº¤äº’

#### ä»»åŠ¡ 5.5: åˆ›å»ºæˆ˜æ–—æ•™ç¨‹/å¼•å¯¼
- **æ–‡ä»¶**: `/home/user/-2/src/components/BattleTutorial.tsx`
- **å†…å®¹**:
  - ä»…åœ¨é¦–æ¬¡æˆ˜æ–—æ—¶æ˜¾ç¤º
  - ç”¨å·¥å…·æç¤ºé«˜äº®UIå…ƒç´ 
  - è§£é‡ŠHPæ¡ã€æŠ€èƒ½ã€æˆ˜æ–—æ—¥å¿—
  - æ·»åŠ "ä¸å†æ˜¾ç¤º"å¤é€‰æ¡†
  - åå¥½è®¾ç½®å­˜å‚¨åœ¨ localStorage
- **éªŒæ”¶**: é¦–æ¬¡æˆ˜æ–—æ˜¾ç¤ºæ•™ç¨‹ï¼ŒåŽç»­å¯ä»¥å…³é—­

---

### Phase 6: é›†æˆä¸Žæµ‹è¯• (5ä¸ªä»»åŠ¡)

#### ä»»åŠ¡ 6.1: æ›´æ–° PlayPage é›†æˆ
- **æ–‡ä»¶**: `/home/user/-2/src/pages/PlayPage.tsx`
- **å†…å®¹**:
  - ä¿®æ”¹"å‘èµ·ä¹æ–—"æŒ‰é’®å¯¼èˆªåˆ° `/battle/:stageId`
  - é€šè¿‡è·¯ç”±å‚æ•°ä¼ é€’å…³å¡æ•°æ®
  - ç§»é™¤å³æ—¶æˆ˜æ–—æ‰§è¡Œ
  - æ·»åŠ æˆ˜æ–—é¢„è§ˆï¼ˆé¢„æœŸéš¾åº¦ï¼‰
- **éªŒæ”¶**: ç‚¹å‡»æŒ‰é’®æ­£ç¡®å¯¼èˆªåˆ°æˆ˜æ–—é¡µé¢

#### ä»»åŠ¡ 6.2: æ›´æ–°å¯¼èˆª
- **æ–‡ä»¶**: `App.tsx`, `BattlePage.tsx`
- **å†…å®¹**:
  - åœ¨ App.tsx ä¸­æ·»åŠ æˆ˜æ–—è·¯ç”±
  - ç¡®ä¿è¿”å›žæŒ‰é’®å›žåˆ° PlayPage
  - æˆ˜æ–—è¿›è¡Œä¸­é˜»æ­¢å¯¼èˆªï¼ˆç¡®è®¤å¯¹è¯æ¡†ï¼‰
  - å¤„ç†æˆ˜æ–—ä¸­çš„æµè§ˆå™¨è¿”å›žæŒ‰é’®
- **éªŒæ”¶**: å¯¼èˆªæµç¨‹ç¬¦åˆé¢„æœŸï¼Œé˜²æ­¢æ„å¤–é€€å‡º

#### ä»»åŠ¡ 6.3: åˆ›å»ºæˆ˜æ–—ç»„ä»¶æµ‹è¯•
- **æ–‡ä»¶**: `/home/user/-2/src/components/__tests__/BattleArena.test.tsx`
- **å†…å®¹**:
  - ç”¨æ¨¡æ‹Ÿæ•°æ®æµ‹è¯•ç»„ä»¶æ¸²æŸ“
  - æµ‹è¯• HPæ¡æ›´æ–°
  - æµ‹è¯•æŠ€èƒ½å†·å´æ˜¾ç¤º
  - æµ‹è¯•æˆ˜æ–—æ—¥å¿—æ¡ç›®æ¸²æŸ“
- **éªŒæ”¶**: æ‰€æœ‰ç»„ä»¶æµ‹è¯•é€šè¿‡

#### ä»»åŠ¡ 6.4: åˆ›å»ºæˆ˜æ–—æµç¨‹æµ‹è¯•
- **æ–‡ä»¶**: `/home/user/-2/src/pages/__tests__/BattlePage.test.tsx`
- **å†…å®¹**:
  - æµ‹è¯•æˆ˜æ–—åˆå§‹åŒ–
  - æµ‹è¯•å›žåˆæŽ¨è¿›
  - æµ‹è¯•è·³è¿‡åŠŸèƒ½
  - æµ‹è¯•æˆ˜æ–—å®Œæˆ
  - æµ‹è¯•é”™è¯¯çŠ¶æ€
- **éªŒæ”¶**: æ‰€æœ‰æµç¨‹æµ‹è¯•é€šè¿‡

#### ä»»åŠ¡ 6.5: æ‰‹åŠ¨ QA æµ‹è¯•
- **æµ‹è¯•æ¸…å•**:
  - [ ] å®Œæ•´æˆ˜æ–—æµç¨‹ï¼ˆå¼€å§‹åˆ°ç»“æŸï¼‰
  - [ ] åŠ¨ç”»æµç•…åº¦éªŒè¯
  - [ ] ç§»åŠ¨ç«¯å“åº”å¼æ£€æŸ¥
  - [ ] æ‰€æœ‰å›žæ”¾æŽ§åˆ¶åŠŸèƒ½
  - [ ] å¥–åŠ±è®¡ç®—éªŒè¯
  - [ ] èƒœåˆ©å’Œå¤±è´¥åœºæ™¯
  - [ ] æš´å‡»åŠ¨ç”»æ£€æŸ¥
  - [ ] é—ªé¿åŠ¨ç”»éªŒè¯
- **éªŒæ”¶**: æ‰€æœ‰æ£€æŸ¥é¡¹é€šè¿‡

---

### Phase 7: é«˜çº§åŠŸèƒ½ï¼ˆæœªæ¥å¢žå¼ºï¼‰(4ä¸ªä»»åŠ¡)

#### ä»»åŠ¡ 7.1: æ·»åŠ æˆ˜æ–—é€Ÿåº¦æŽ§åˆ¶
- **å†…å®¹**:
  - æ·»åŠ é€Ÿåº¦å€æ•°: 0.5x, 1x, 2x, 4x
  - ç›¸åº”è°ƒæ•´åŠ¨ç”»æ—¶é—´
  - åå¥½è®¾ç½®ä¿å­˜åˆ° localStorage
  - åœ¨UIä¸­æ˜¾ç¤ºé€Ÿåº¦æŒ‡ç¤ºå™¨
- **ä¼˜å…ˆçº§**: ä¸­

#### ä»»åŠ¡ 7.2: æ·»åŠ æˆ˜æ–—é‡æ’­åŠŸèƒ½
- **å†…å®¹**:
  - ä¿å­˜å¸¦é‡æ’­æ•°æ®çš„æˆ˜æ–—è®°å½•
  - åœ¨ LogPage æ·»åŠ "é‡æ’­"æŒ‰é’®
  - åŠ è½½ä¿å­˜çš„æˆ˜æ–—è¿›è¡Œå›žæ”¾
  - å…è®¸åˆ†äº«æˆ˜æ–—é‡æ’­ï¼ˆæœªæ¥ï¼‰
- **ä¼˜å…ˆçº§**: ä¸­

#### ä»»åŠ¡ 7.3: æ·»åŠ æˆ˜æ–—ç»Ÿè®¡
- **å†…å®¹**:
  - è·Ÿè¸ªæˆ˜æ–—æŒ‡æ ‡ï¼ˆå¹³å‡ä¼¤å®³ã€æš´å‡»çŽ‡ç­‰ï¼‰
  - æ˜¾ç¤ºæˆ˜æ–—åŽç»Ÿè®¡å±å¹•
  - è·¨æˆ˜æ–—æ¯”è¾ƒè¡¨çŽ°
  - æ·»åŠ åˆ°è‹±é›„èµ„æ–™
- **ä¼˜å…ˆçº§**: ä½Ž

#### ä»»åŠ¡ 7.4: æ·»åŠ é«˜çº§è§†è§‰ç‰¹æ•ˆ
- **å†…å®¹**:
  - æš´å‡»æ—¶çš„ç›¸æœºéœ‡åŠ¨
  - å¼ºåŠ›æ”»å‡»æ—¶çš„å±å¹•é—ªå…‰
  - æœ€åŽä¸€å‡»çš„æ…¢åŠ¨ä½œ
  - åŸºäºŽæˆ˜æ–—çŠ¶æ€çš„åŠ¨æ€èƒŒæ™¯å˜åŒ–
- **ä¼˜å…ˆçº§**: ä½Ž

---

## ðŸ“ æ–‡ä»¶ç»“æž„æ¦‚è§ˆ

å®žæ–½åŽçš„æ–°æ–‡ä»¶ç»“æž„ï¼š

```
/home/user/-2/src/
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ BattlePage.tsx                    # ä¸»æˆ˜æ–—å±å¹•
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ BattleArena.tsx                   # ç«žæŠ€åœºå®¹å™¨
â”‚   â”œâ”€â”€ CombatantCard.tsx                 # è‹±é›„/æ•Œäººæ˜¾ç¤º
â”‚   â”œâ”€â”€ HPBar.tsx                         # è¡€æ¡
â”‚   â”œâ”€â”€ SkillBar.tsx                      # æŠ€èƒ½æ˜¾ç¤º
â”‚   â”œâ”€â”€ BattleLog.tsx                     # æ—¥å¿—å®¹å™¨
â”‚   â”œâ”€â”€ BattleLogEntry.tsx                # å•æ¡æ—¥å¿—
â”‚   â”œâ”€â”€ BattleControls.tsx                # å›žæ”¾æŽ§åˆ¶
â”‚   â”œâ”€â”€ DamageNumber.tsx                  # é£˜å­—ä¼¤å®³
â”‚   â”œâ”€â”€ AttackEffect.tsx                  # æ”»å‡»åŠ¨ç”»
â”‚   â”œâ”€â”€ ParticleEffect.tsx                # ç²’å­ç³»ç»Ÿ
â”‚   â”œâ”€â”€ BattleResultModal.tsx             # èƒœåˆ©/å¤±è´¥å¼¹çª—
â”‚   â””â”€â”€ BattleTutorial.tsx                # æ–°æ‰‹å¼•å¯¼
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useBattlePlayback.ts              # å›žæ”¾é€»è¾‘
â”‚   â””â”€â”€ useBattleAnimation.ts             # åŠ¨ç”»çŠ¶æ€
â”œâ”€â”€ domain/
â”‚   â””â”€â”€ battleAnimationConfig.ts          # åŠ¨ç”»å¸¸é‡
â””â”€â”€ utils/
    â””â”€â”€ soundManager.ts                   # éŸ³æ•ˆç®¡ç†ï¼ˆå¯é€‰ï¼‰
```

**æ–°å¢žæ–‡ä»¶æ•°**: 17ä¸ªæ ¸å¿ƒæ–‡ä»¶

---

## ðŸŽ¨ CSS åŠ¨ç”»æŒ‡å—

### Tailwind ç±»ä½¿ç”¨

```css
/* å…¥åœºåŠ¨ç”» */
.animate-slide-in-left { animation: slideInLeft 0.5s ease-out; }
.animate-slide-in-right { animation: slideInRight 0.5s ease-out; }
.animate-fade-in { animation: fadeIn 0.3s ease-in; }

/* æˆ˜æ–—åŠ¨ç”» */
.animate-glow { animation: glow 0.3s ease-in-out; }
.animate-shake { animation: shake 0.4s ease-in-out; }
.animate-bounce { animation: bounce 0.6s ease-in-out; }

/* ä¼¤å®³æ•°å­— */
.animate-float-up { animation: floatUp 1.5s ease-out forwards; }

/* è¿‡æ¸¡ */
.transition-width { transition: width 0.5s ease-out; }
.transition-opacity { transition: opacity 0.3s ease-in-out; }
```

### è‡ªå®šä¹‰ Keyframesï¼ˆæ·»åŠ åˆ° index.cssï¼‰

```css
@keyframes slideInLeft {
  from { transform: translateX(-100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

@keyframes slideInRight {
  from { transform: translateX(100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

@keyframes glow {
  0%, 100% { box-shadow: 0 0 5px rgba(14, 165, 233, 0.5); }
  50% { box-shadow: 0 0 20px rgba(14, 165, 233, 1); }
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  75% { transform: translateX(5px); }
}

@keyframes floatUp {
  0% { transform: translateY(0); opacity: 1; }
  100% { transform: translateY(-50px); opacity: 0; }
}
```

---

## ðŸ“¦ ç±»åž‹å®šä¹‰è¡¥å……

éœ€è¦æ·»åŠ çš„æ–°ç±»åž‹å®šä¹‰ï¼š

```typescript
// src/types/battle.ts
export interface BattleUIState {
  currentTurnIndex: number;
  isPlaying: boolean;
  speed: 1 | 2 | 4;
  showTutorial: boolean;
}

export interface AnimationState {
  attackerGlow: boolean;
  defenderHit: boolean;
  damageNumber: { value: number; position: { x: number; y: number } } | null;
  particleEffect: 'crit' | 'miss' | null;
}

export interface BattleRewards {
  exp: number;
  silver: number;
  items?: { id: string; name: string; quantity: number }[];
}
```

---

## âš¡ æ€§èƒ½ç›®æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | è¯´æ˜Ž |
|------|--------|------|
| åˆå§‹åŠ è½½ | < 500ms | æˆ˜æ–—é¡µé¢å°±ç»ªæ—¶é—´ |
| å›žåˆåŠ¨ç”» | ~2ç§’ | å¯é€šè¿‡é€Ÿåº¦æŽ§åˆ¶è°ƒæ•´ |
| æ€»æˆ˜æ–—æ—¶é•¿ | 30-60ç§’ | å…¸åž‹15-20å›žåˆæˆ˜æ–— |
| å¸§çŽ‡ | 60fps | æ‰€æœ‰åŠ¨ç”»ä¿æŒæµç•… |
| ç§»åŠ¨æ€§èƒ½ | æµç•… | 2020å¹´åŽè®¾å¤‡ |

---

## ðŸ§ª æµ‹è¯•ç­–ç•¥

### 1. å•å…ƒæµ‹è¯•
- ç‹¬ç«‹ç»„ä»¶æµ‹è¯•ï¼ˆHPBar, SkillBarç­‰ï¼‰
- Mockæ•°æ®æ¸²æŸ“éªŒè¯
- Propså˜åŒ–å“åº”æµ‹è¯•

### 2. é›†æˆæµ‹è¯•
- æˆ˜æ–—æµç¨‹æµ‹è¯•ï¼ˆuseBattlePlayback, çŠ¶æ€æ›´æ–°ï¼‰
- Hook é€»è¾‘éªŒè¯
- çŠ¶æ€ç®¡ç†é›†æˆ

### 3. è§†è§‰å›žå½’æµ‹è¯•
- åŠ¨ç”»æˆªå›¾å¯¹æ¯”
- å…³é”®å¸§éªŒè¯
- å¸ƒå±€ä¸€è‡´æ€§æ£€æŸ¥

### 4. æ€§èƒ½æµ‹è¯•
- åŠ¨ç”»å¸§çŽ‡ç›‘æŽ§
- å†…å­˜ä½¿ç”¨åˆ†æž
- æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–éªŒè¯

### 5. æ— éšœç¢æµ‹è¯•
- axe-core è‡ªåŠ¨åŒ–æµ‹è¯•
- é”®ç›˜å¯¼èˆªéªŒè¯
- å±å¹•é˜…è¯»å™¨å…¼å®¹æ€§

### 6. æ‰‹åŠ¨ QA
- è·¨æµè§ˆå™¨æµ‹è¯•ï¼ˆChrome, Firefox, Safari, ç§»åŠ¨ç«¯ï¼‰
- å¤šè®¾å¤‡å°ºå¯¸éªŒè¯
- ç”¨æˆ·ä½“éªŒæµç¨‹æµ‹è¯•

---

## ðŸ”‘ å…³é”®å®žæ–½æ–‡ä»¶ï¼ˆä¼˜å…ˆçº§æŽ’åºï¼‰

æŒ‰é‡è¦æ€§å’Œä¾èµ–å…³ç³»æŽ’åºçš„æ ¸å¿ƒæ–‡ä»¶ï¼š

1. **`/home/user/-2/src/pages/BattlePage.tsx`**
   - ä¸»æˆ˜æ–—å±å¹•å®¹å™¨ï¼Œç¼–æŽ’æ‰€æœ‰ç»„ä»¶å’Œç®¡ç†æˆ˜æ–—æµç¨‹
   - æ•´ä¸ªæˆ˜æ–—å¯è§†åŒ–ç³»ç»Ÿçš„å…¥å£ç‚¹

2. **`/home/user/-2/src/hooks/useBattlePlayback.ts`**
   - æ ¸å¿ƒæˆ˜æ–—å›žæ”¾é€»è¾‘ï¼Œå°†æˆ˜æ–—æ¨¡æ‹Ÿç»“æžœè½¬æ¢ä¸ºé€å¸§åŠ¨ç”»çŠ¶æ€
   - åè°ƒå›žåˆæŽ¨è¿›å’ŒHPæ›´æ–°çš„å…³é”®

3. **`/home/user/-2/src/components/BattleArena.tsx`**
   - ä¸­å¿ƒç«žæŠ€åœºç»„ä»¶ï¼Œæ¸²æŸ“æˆ˜æ–—è€…ã€ç®¡ç†å¸ƒå±€ã€åè°ƒæ‰€æœ‰æˆ˜æ–—åŠ¨ç”»
   - æˆ˜æ–—ç”»é¢çš„è§†è§‰æ ¸å¿ƒ

4. **`/home/user/-2/src/domain/battle.ts`**
   - çŽ°æœ‰æˆ˜æ–—æ¨¡æ‹Ÿé€»è¾‘ï¼ˆå·²å®žçŽ°ï¼‰
   - åŒ…å«é©±åŠ¨UIçš„æ•°æ®ç»“æž„ï¼ˆBattleRecord, TurnLogEntryï¼‰

5. **`/home/user/-2/src/state/gameStore.ts`**
   - éœ€è¦æ‰©å±•çš„ Zustand store
   - æ”¯æŒæ´»è·ƒæˆ˜æ–—è·Ÿè¸ªã€å›žæ”¾çŠ¶æ€å’Œæˆ˜æ–—åˆå§‹åŒ– actions

---

## ðŸ“š ç ”ç©¶æ¥æº

æœ¬è®¡åˆ’åŸºäºŽä»¥ä¸‹2025å¹´æœ€æ–°èµ„æºï¼š

- [Top 7 Stunning Mobile Game UI Designs](https://allclonescript.com/blog/mobile-game-app-ui-designs)
- [Strategy Game Battle UI - Medium](https://medium.com/@treeform/strategy-game-battle-ui-3b313ffd3769)
- [8 Comprehensive Android RPG Game Reviews 2025](https://www.musesymphony.com/comprehensive-android-rpg-game-reviews-2025/)
- [How to Create a Seamless UI/UX in Mobile Games](https://appsamurai.com/blog/how-to-create-a-seamless-ui-ux-in-mobile-games/)
- [Best Practices for Game UI/UX Design](https://genieee.com/best-practices-for-game-ui-ux-design/)
- [Game UI: design principles, best practices, and examples](https://www.justinmind.com/ui-design/game)
- [Best Examples in Mobile Game UI Designs (2025 Review)](https://pixune.com/blog/best-examples-mobile-game-ui-design/)
- [Game UI Database](https://www.gameuidatabase.com/)
- [Devlog #10: Redesigning Combat UI](https://smallgraygames.itch.io/south-of-the-march/devlog/781505/devlog-10-redesigning-combat-ui)
- [What Is UI Animation? - IxDF](https://www.interaction-design.org/literature/topics/ui-animation)
- [The State of UX in 2025](https://trends.uxdesign.cc/)

---

## ðŸš€ å®žæ–½å»ºè®®

### æŽ¨èæ‰§è¡Œé¡ºåº

1. **Phase 1-2 (åŸºç¡€ + çŠ¶æ€)**: å»ºç«‹åšå®žçš„ç»„ä»¶å’ŒçŠ¶æ€åŸºç¡€
2. **Phase 4 (é›†æˆ)**: åœ¨æ·»åŠ å¤æ‚åŠ¨ç”»å‰å…ˆæ‰“é€šæ ¸å¿ƒæµç¨‹
3. **Phase 3 (åŠ¨ç”»)**: åœ¨æµç¨‹ç¨³å®šåŽæ·»åŠ è§†è§‰æ•ˆæžœ
4. **Phase 5-6 (ä¼˜åŒ– + æµ‹è¯•)**: æ€§èƒ½è°ƒä¼˜å’Œå…¨é¢æµ‹è¯•
5. **Phase 7 (é«˜çº§åŠŸèƒ½)**: å¯é€‰çš„å¢žå¼ºåŠŸèƒ½

### MVP æœ€å°å¯è¡Œç‰ˆæœ¬

å¦‚æžœéœ€è¦å¿«é€ŸåŽŸåž‹ï¼Œå¯ä»¥å…ˆå®žæ–½ï¼š
- Phase 1: æ‰€æœ‰åŸºç¡€ç»„ä»¶
- Phase 2: çŠ¶æ€ç®¡ç†
- Phase 4.1-4.2: åŸºæœ¬å›žæ”¾æµç¨‹
- è·³è¿‡é«˜çº§åŠ¨ç”»ï¼Œä½¿ç”¨ç®€å•çš„CSSè¿‡æ¸¡

### å¼€å‘èŠ‚å¥å»ºè®®

- **æ¯å¤©**: 3-5ä¸ªé¢—ç²’åº¦ä»»åŠ¡
- **æ¯å‘¨**: å®Œæˆ1-2ä¸ªPhase
- **æ€»é¢„ä¼°**: 3-4å‘¨å®Œæˆ Phase 1-6

---

## âœ… éªŒæ”¶æ ‡å‡†

æˆ˜æ–—ç”»é¢åŠŸèƒ½å®Œæˆçš„æ ‡å‡†ï¼š

- [ ] ç”¨æˆ·å¯ä»¥ä»Ž PlayPage å¯åŠ¨å¯è§†åŒ–æˆ˜æ–—
- [ ] æˆ˜æ–—ä»¥åŠ¨ç”»å½¢å¼é€å›žåˆæ’­æ”¾
- [ ] HPæ¡ã€æŠ€èƒ½ã€æ—¥å¿—å®žæ—¶æ›´æ–°
- [ ] æ”¯æŒæ’­æ”¾/æš‚åœ/è·³è¿‡æŽ§åˆ¶
- [ ] æš´å‡»å’Œé—ªé¿æœ‰è§†è§‰åŒºåˆ†
- [ ] æˆ˜æ–—ç»“æŸæ˜¾ç¤ºç»“æžœå’Œå¥–åŠ±
- [ ] ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯å“åº”å¼æ­£å¸¸
- [ ] 60fps æµç•…åŠ¨ç”»
- [ ] é€šè¿‡æ‰€æœ‰å•å…ƒå’Œé›†æˆæµ‹è¯•
- [ ] æ— éšœç¢åŠŸèƒ½ç¬¦åˆæ ‡å‡†

---

## ðŸ“ åŽç»­ç»´æŠ¤

å®žæ–½å®ŒæˆåŽçš„ç»´æŠ¤å»ºè®®ï¼š

1. **æ€§èƒ½ç›‘æŽ§**: å®šæœŸæ£€æŸ¥åŠ¨ç”»å¸§çŽ‡å’Œå†…å­˜ä½¿ç”¨
2. **ç”¨æˆ·åé¦ˆ**: æ”¶é›†æˆ˜æ–—ä½“éªŒåé¦ˆï¼Œè¿­ä»£ä¼˜åŒ–
3. **æ–°æŠ€èƒ½ç‰¹æ•ˆ**: ä¸ºæ–°å¢žæŠ€èƒ½æ·»åŠ å¯¹åº”çš„è§†è§‰æ•ˆæžœ
4. **å¹³è¡¡è°ƒæ•´**: æ ¹æ®å®žé™…è¡¨çŽ°è°ƒæ•´åŠ¨ç”»æ—¶é•¿
5. **æµè§ˆå™¨å…¼å®¹**: å…³æ³¨æ–°æµè§ˆå™¨ç‰ˆæœ¬çš„å…¼å®¹æ€§

---

## ðŸŽ¯ æ€»ç»“

æœ¬è®¡åˆ’æä¾›äº†ä¸€ä¸ªå…¨é¢çš„æˆ˜æ–—ç”»é¢å®žæ–½è·¯çº¿å›¾ï¼ŒåŒ…å«ï¼š

- âœ… 60+ ä¸ªæœ€å°é¢—ç²’åº¦ä»»åŠ¡
- âœ… åŸºäºŽ2025å¹´æœ€ä½³å®žè·µçš„çŽ°ä»£è®¾è®¡
- âœ… å®Œæ•´çš„ç»„ä»¶ã€Hookã€åŠ¨ç”»æž¶æž„
- âœ… è¯¦ç»†çš„æ€§èƒ½å’Œæµ‹è¯•æ ‡å‡†
- âœ… æ¸…æ™°çš„ä¼˜å…ˆçº§å’Œä¾èµ–å…³ç³»

**å‡†å¤‡å¼€å§‹å®žæ–½ï¼** ðŸš€
